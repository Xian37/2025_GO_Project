# 聊天室專案進度報告
**日期：** 2025年12月2日  
**專案名稱：** 🌟 Group 22 多人線上聊天室 🌟  
**GitHub：** https://github.com/Xian37/2025_GO_Project.git

---

## 📊 專案概述

本專案為一個功能完整的即時多人線上聊天室，採用 Go 後端搭配 WebSocket 技術，前端使用原生 JavaScript 實現，具備宇宙星空主題的沉浸式視覺效果。

---

## ✅ 已完成功能

### 🎨 視覺與介面優化
- **宇宙星空背景系統**
  - Canvas 2D 渲染引擎
  - 4顆行星（透明度40%避免遮擋文字）
  - 衛星軌道動畫
  - 5個星雲效果
  - 流星系統（隨機生成）
  - 1500顆星星背景

- **介面美化**
  - 漸變背景與發光邊框
  - 模糊效果（backdrop-filter: blur(15px)）
  - 雙層陰影設計
  - Hover 動畫效果
  - 響應式佈局（適應25%-200%縮放）
  - 自定義滾動條（天藍色主題）

### 👤 用戶系統
- **頭貼系統**
  - 10個預設 emoji 頭貼
  - 14張自訂圖片頭貼（avatars/ 目錄）
  - 支援上傳自訂圖片（base64 編碼）
  - 頭貼尺寸：50px × 50px（已放大）

- **名字生成器**
  - 24個形容詞 + 62個名詞組合
  - 特殊名字「藥律工」和「zelpha」各24%出現率
  - 1-2顆星星裝飾
  - 🎲 骰子按鈕一鍵生成

- **唯一 ID 系統**
  - 格式：4英文字母 + 4數字（如 ABCD1234）
  - localStorage 持久化
  - 用於區分不同裝置用戶

### 🎮 等級與成就系統
- **等級系統**
  - 30級等級上限
  - 經驗值表（100-23300 EXP）
  - 發送訊息獲得經驗
  - 升級動畫效果
  - 側邊欄顯示等級進度條

- **稱號系統**（優先級排序）
  1. 新手（Lv.1+）
  2. 活躍者（50條訊息）
  3. 大師（Lv.10+）
  4. 老手（200條訊息）
  5. 傳奇（Lv.20+）
  6. 冠軍（500條訊息）

- **成就系統**（12項成就）
  - 初次發言、健談、話癆、聊天大師
  - 小有名氣、知名人士、傳奇人物
  - 民主先鋒、出題者、反應靈敏
  - 語音達人、攝影師
  - 進度追蹤與通知

### 💬 聊天功能
- **多種訊息類型**
  - 文字訊息（支援 Markdown）
  - 圖片訊息（5MB 限制）
  - 語音訊息（錄音與播放）
  - GIF 動圖（Tenor API 整合）
  - 貼圖系統

- **Markdown 支援**
  - 標題（H1-H3）
  - 列表（有序/無序）
  - 程式碼高亮（highlight.js）
  - 引用區塊
  - 表格
  - 超連結
  - 分隔線

- **互動功能**
  - 表情回應（👍❤️😂😮😢）
  - 引用回覆訊息
  - 投票功能（多選項）
  - 搶答系統
  - 查看他人資料（點擊名字）

### 🔊 語音功能
- **語音輸入**
  - Web Speech API
  - 多語言支援（繁體中文、英文等）
  - 即時轉錄顯示
  - 連續辨識模式

- **文字朗讀（TTS）**
  - Speech Synthesis API
  - 可調整速度（0.5-2.0）
  - 可調整音調（0.5-2.0）
  - 自動朗讀新訊息
  - 語音命令支援

### 🏠 房間系統
- **聊天大廳**（主房間，原 lobby）
- **自訂房間**
  - 建立或加入房間
  - 密碼保護選項
  - 房間列表顯示
  - 房間切換動畫
  - 訊息隔離

### 🛠️ 系統功能
- **清除訊息**
  - 清除本地訊息記錄
  - 刷新後保持清除狀態
  - localStorage 標記追蹤
  - 過濾歷史訊息（chat、image、voice、gif、join、leave）

- **在線狀態**
  - 即時人數顯示
  - WebSocket 連線狀態
  - 自動重連機制（指數退避）

- **個人資料面板**
  - 頭貼、暱稱、等級、稱號、ID
  - 統計數據（等級、稱號、訊息數）
  - 成就列表
  - 徽章展示

---

## 🔧 技術細節

### 後端技術棧
- **語言：** Go 1.x
- **框架：** Gorilla WebSocket
- **架構：** MVC 模式
  - `models/` - 資料模型
  - `service/` - 業務邏輯
  - `transport/` - WebSocket 處理
  - `static/` - 前端資源

### 前端技術棧
- **核心：** 原生 JavaScript（ES6+）
- **渲染：** HTML5 Canvas（宇宙背景）
- **通訊：** WebSocket API
- **儲存：** localStorage
- **外部庫：**
  - marked.js - Markdown 解析
  - highlight.js - 程式碼高亮
  - Tenor API - GIF 搜尋

### 資料模型
```go
type Message struct {
    Type      string            // chat, image, voice, gif, join, leave, vote, quiz...
    Room      string            // 房間名稱
    Nickname  string            // 用戶暱稱
    Avatar    string            // 頭貼（emoji/base64/路徑）
    UserId    string            // 唯一 ID
    Content   string            // 訊息內容
    Timestamp string            // 時間戳
    Level     int               // 等級
    Title     string            // 稱號
    ReplyTo   *Message          // 引用訊息
}
```

---

## 🐛 已修復問題

### 佈局與顯示問題
1. ✅ **行星亮度遮擋文字** → 降低透明度至40%
2. ✅ **頭貼選擇欄位消失** → 修復 avatarPreview 變數順序
3. ✅ **輸入框溢出容器** → 調整 flex 佈局與 box-sizing
4. ✅ **聊天內容超出邊框** → 設定 overflow 與高度限制
5. ✅ **按鈕被截斷（F5刷新）** → 調整容器高度為 max-height: 90vh
6. ✅ **滾動條不顯示** → 改用 overflow-y: scroll 並自定義樣式
7. ✅ **名字斷行問題** → 添加 white-space: nowrap
8. ✅ **不同縮放級別顯示異常** → 使用 vh 單位與 flex 佈局

### 功能性問題
9. ✅ **清除訊息後刷新仍顯示** → 實作 isReceivingHistory 追蹤機制
10. ✅ **清除後新訊息不顯示** → 區分歷史訊息與即時訊息
11. ✅ **F5 刷新經驗值自動增加** → 避免在 checkExistingLogin 觸發 checkAchievements
12. ✅ **JavaScript 語法錯誤（大括號不配對）** → 移除多餘的閉合括號

### UI/UX 改進
13. ✅ **頭貼太小** → 從 40px 增加到 50px
14. ✅ **Lobby 中英文混用** → 統一改為「聊天大廳」
15. ✅ **介面不夠美觀** → 添加漸變、陰影、邊框、動畫效果
16. ✅ **缺少網站介紹** → 首頁添加功能介紹區塊

---

## 📈 專案統計

- **前端代碼：** index.html（3177行）
- **後端代碼：** 
  - main.go
  - service/service.go（368行）
  - models/models.go
  - transport/websocket.go
- **頭貼資源：** 14張圖片（avatars/ 目錄）
- **Git 提交：** 74892c6（最新）
- **功能模組：** 12個主要功能區塊
- **成就數量：** 12項
- **稱號數量：** 6種
- **支援訊息類型：** 10種+

---

## 🎯 核心優勢

1. **完整的用戶體驗**
   - 從登入到聊天的流暢體驗
   - 個性化設定（頭貼、名字、ID）
   - 遊戲化元素（等級、成就、稱號）

2. **豐富的互動功能**
   - 多種訊息格式
   - 即時反應與回覆
   - 投票與搶答系統

3. **美觀的視覺設計**
   - 獨特的宇宙主題
   - 精緻的動畫效果
   - 響應式佈局

4. **穩定的技術架構**
   - WebSocket 即時通訊
   - 自動重連機制
   - 資料持久化

5. **無障礙支援**
   - 語音輸入與朗讀
   - 多語言支援
   - 鍵盤快捷鍵

---

## 🚀 部署資訊

- **開發環境：** Windows + VS Code
- **版本控制：** Git + GitHub
- **倉庫地址：** https://github.com/Xian37/2025_GO_Project.git
- **分支：** main
- **最新提交：** 74892c6 - "優化聊天室功能：修復佈局問題、改進清除訊息、更新標題為Group 22"

---

## 📝 更新日誌（2025-12-02）

### 新增功能
- 🌟 更新專案標題為「Group 22 多人線上聊天室」
- 📖 首頁添加8項主要功能介紹
- 🔍 放大頭貼尺寸提升視覺效果
- 🎨 自定義滾動條樣式

### 問題修復
- 🐛 修復多種佈局溢出問題
- 🐛 完善清除訊息功能（支援刷新保持）
- 🐛 修復經驗值異常增加
- 🐛 解決名字斷行問題
- 🐛 適配不同瀏覽器縮放級別

### 優化改進
- ⚡ 改進歷史訊息過濾邏輯
- ⚡ 優化 Flexbox 佈局計算
- ⚡ 提升響應式設計穩定性
- ⚡ 增強 localStorage 數據管理

---

## 🎓 技術亮點

1. **創新的訊息過濾機制**
   - 使用 `isReceivingHistory` 標記區分歷史與即時訊息
   - 2秒超時自動切換狀態
   - 完美解決清除訊息的持久化問題

2. **響應式佈局方案**
   - 使用 vh 單位適配不同視窗高度
   - Flexbox 彈性佈局
   - box-sizing: border-box 統一計算
   - 支援 25%-200% 瀏覽器縮放

3. **等級系統設計**
   - 指數增長的經驗值曲線
   - 優先級排序的稱號系統
   - 實時 UI 更新不觸發副作用

4. **Canvas 動畫優化**
   - requestAnimationFrame 流暢渲染
   - 分層繪製（背景 → 星雲 → 星星 → 行星 → 流星）
   - 性能優化的粒子系統

---

## 💡 未來展望

### 潛在擴充功能
- 🔐 用戶註冊與登入系統
- 💾 雲端數據同步
- 🎵 背景音樂與音效
- 🎮 更多互動遊戲
- 📱 移動端優化
- 🌍 多語言界面
- 🔔 桌面通知
- 📊 數據統計儀表板

### 技術優化方向
- 使用 TypeScript 重構前端
- 引入 React/Vue 框架
- 實作 Redis 快取
- 加入 Docker 容器化
- CI/CD 自動部署
- 單元測試覆蓋
- 性能監控系統

---

## 👥 團隊資訊

**團隊名稱：** Group 22  
**專案性質：** 學術專案 / Go 語言實戰練習  
**開發時間：** 2024年11月 - 2025年12月  
**技術顧問：** GitHub Copilot (Claude Sonnet 4.5)

---

## 📞 聯絡方式

- **GitHub：** https://github.com/Xian37/2025_GO_Project
- **問題回報：** GitHub Issues
- **功能建議：** GitHub Discussions

---

**報告生成時間：** 2025年12月2日  
**文件版本：** v1.0  
**狀態：** ✅ 專案功能完整，運行穩定

---

*本報告由 GitHub Copilot 自動生成，涵蓋專案所有主要功能、技術細節與開發歷程。*
